1710615966.593456 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:91 __init__ INFO: Starting DataFlowKernel with config
Config(
    app_cache=True, 
    checkpoint_files=None, 
    checkpoint_mode=None, 
    checkpoint_period=None, 
    executors=(HighThroughputExecutor(
        address='140.221.79.12', 
        address_probe_timeout=None, 
        available_accelerators=['0', '1'], 
        block_error_handler=<function simple_error_handler at 0x7ff881089260>, 
        cores_per_worker=1.0, 
        cpu_affinity='block', 
        heartbeat_period=30, 
        heartbeat_threshold=120, 
        interchange_port_range=(55000, 56000), 
        label='htex', 
        launch_cmd='process_worker_pool.py {debug} {max_workers} -a {addresses} -p {prefetch_capacity} -c {cores_per_worker} -m {mem_per_worker} --poll {poll_period} --task_port={task_port} --result_port={result_port} --logdir={logdir} --block_id={{block_id}} --hb_period={heartbeat_period} {address_probe_timeout_string} --hb_threshold={heartbeat_threshold} --cpu-affinity {cpu_affinity} --available-accelerators {accelerators}', 
        max_workers=inf, 
        mem_per_worker=None, 
        poll_period=10, 
        prefetch_capacity=0, 
        provider=LocalProvider(
            channel=LocalChannel(
                envs={}, 
                script_dir=None, 
                userhome='/lambda_stor/data/avasan/ESM_BindAlign'
            ), 
            cmd_timeout=30, 
            init_blocks=1, 
            launcher=SingleNodeLauncher(debug=True, fail_on_any=False), 
            max_blocks=1, 
            min_blocks=0, 
            move_files=None, 
            nodes_per_block=1, 
            parallelism=1, 
            worker_init=''
        ), 
        storage_access=None, 
        worker_debug=False, 
        worker_logdir_root=None, 
        worker_port_range=(10000, 20000), 
        worker_ports=None, 
        working_dir=None
    ),), 
    garbage_collect=True, 
    initialize_logging=True, 
    internal_tasks_max_threads=10, 
    max_idletime=120.0, 
    monitoring=None, 
    retries=1, 
    retry_handler=None, 
    run_dir='dataset/smineg_embeddings/parsl', 
    strategy='simple', 
    usage_tracking=False
)
1710615966.640638 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:93 __init__ INFO: Parsl version: 2024.01.29
1710615966.640770 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.usage_tracking.usage:127 __init__ DEBUG: Tracking status: False
1710615966.640892 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:121 __init__ INFO: Run id is: 4c03ec53-b4bf-45dc-9cb1-b1b549efad8f
1710615966.667681 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:128 __init__ DEBUG: Considering candidate for workflow name: /homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py
1710615966.667813 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:128 __init__ DEBUG: Considering candidate for workflow name: /homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/typeguard/__init__.py
1710615966.667848 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:128 __init__ DEBUG: Considering candidate for workflow name: /homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/concurrent/__init__.py
1710615966.667885 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:128 __init__ DEBUG: Considering candidate for workflow name: /lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py
1710615966.667936 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:134 __init__ DEBUG: Using distributed_inference.py as workflow name
1710615966.668142 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:163 __init__ INFO: App caching initialized
1710615966.668191 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.jobs.strategy:143 __init__ DEBUG: Scaling strategy: simple
1710615966.692179 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:475 _start_queue_management_thread DEBUG: Starting queue management thread
1710615966.692390 2024-03-16 12:06:06 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:365 _queue_management_worker DEBUG: Queue management worker starting
1710615966.692457 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:479 _start_queue_management_thread DEBUG: Started queue management thread
1710615966.692730 2024-03-16 12:06:06 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710615966.997244 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:338 start DEBUG: Created management thread: <Thread(HTEX-Queue-Management-Thread, started daemon 140704940553984)>
1710615966.997539 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:313 initialize_scaling DEBUG: Launch command: process_worker_pool.py   -a 140.221.79.12 -p 0 -c 1.0 -m None --poll 10 --task_port=17135 --result_port=12561 --logdir=/lambda_stor/data/avasan/ESM_BindAlign/dataset/smineg_embeddings/parsl/001/htex --block_id={block_id} --hb_period=30  --hb_threshold=120 --cpu-affinity block --available-accelerators 0 1
1710615966.997580 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:315 initialize_scaling DEBUG: Starting HighThroughputExecutor with provider:
LocalProvider(
    channel=LocalChannel(
        envs={}, 
        script_dir='/lambda_stor/data/avasan/ESM_BindAlign/dataset/smineg_embeddings/parsl/001/submit_scripts', 
        userhome='/lambda_stor/data/avasan/ESM_BindAlign'
    ), 
    cmd_timeout=30, 
    init_blocks=1, 
    launcher=SingleNodeLauncher(debug=True, fail_on_any=False), 
    max_blocks=1, 
    min_blocks=0, 
    move_files=None, 
    nodes_per_block=1, 
    parallelism=1, 
    worker_init=''
)
1710615966.998796 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.status_handling:194 scale_out INFO: Scaling out by 1 blocks
1710615966.998862 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.status_handling:197 scale_out INFO: Allocated block ID 0
1710615966.998924 2024-03-16 12:06:06 MainProcess-312066 MainThread-140708346079040 parsl.executors.status_handling:225 _launch_block DEBUG: Submitting to provider with job_name parsl.htex.block-0
1710615967.065129 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.providers.local.local:219 submit DEBUG: Launching
1710615967.108342 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.status_handling:228 _launch_block DEBUG: Launched block 0 on executor htex with job ID 312112
1710615967.108628 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.jobs.job_status_poller:128 add_executors DEBUG: Adding executor htex
1710615967.110462 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 0 will be sent to executor htex
1710615967.110694 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.110749 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 0 submitted for App wrapper, not waiting on any dependency
1710615967.110836 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 0 set to pending state with AppFuture: <AppFuture at 0x7ff87cfa6190 state=pending>
1710615967.110899 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 0 will not be memoized
1710615967.111022 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_train_neg.smi'),)
1710615967.115069 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.115168 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.115214 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 0 try 0 launched on executor htex with executor id 1
1710615967.115289 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 1 will be sent to executor htex
1710615967.115338 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.115371 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 1 submitted for App wrapper, not waiting on any dependency
1710615967.115406 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 1 set to pending state with AppFuture: <AppFuture at 0x7ff87d5ca050 state=pending>
1710615967.115436 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 1 will not be memoized
1710615967.115478 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_test_neg.smi'),)
1710615967.115535 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.115575 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.115604 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 1 try 0 launched on executor htex with executor id 2
1710615967.115640 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 2 will be sent to executor htex
1710615967.115693 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.115725 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 2 submitted for App wrapper, not waiting on any dependency
1710615967.115758 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 2 set to pending state with AppFuture: <AppFuture at 0x7ff87b90a090 state=pending>
1710615967.115788 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 2 will not be memoized
1710615967.115824 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_val_neg.smi'),)
1710615967.115888 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.115926 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.115959 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 2 try 0 launched on executor htex with executor id 3
1710615967.115997 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 3 will be sent to executor htex
1710615967.116035 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.116065 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 3 submitted for App wrapper, not waiting on any dependency
1710615967.116096 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 3 set to pending state with AppFuture: <AppFuture at 0x7ff87b90a3d0 state=pending>
1710615967.116124 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 3 will not be memoized
1710615967.116162 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_train_neg.smi'),)
1710615967.116221 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.116259 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.116288 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 3 try 0 launched on executor htex with executor id 4
1710615967.116323 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 4 will be sent to executor htex
1710615967.116365 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.116398 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 4 submitted for App wrapper, not waiting on any dependency
1710615967.116429 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 4 set to pending state with AppFuture: <AppFuture at 0x7ff87b90a710 state=pending>
1710615967.116456 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 4 will not be memoized
1710615967.116498 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_test_neg.smi'),)
1710615967.116550 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.116596 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.116643 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 4 try 0 launched on executor htex with executor id 5
1710615967.116677 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 5 will be sent to executor htex
1710615967.116714 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.116743 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 5 submitted for App wrapper, not waiting on any dependency
1710615967.116780 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 5 set to pending state with AppFuture: <AppFuture at 0x7ff87b90a9d0 state=pending>
1710615967.116808 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 5 will not be memoized
1710615967.116844 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_val_neg.smi'),)
1710615967.116895 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.116934 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.116963 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 5 try 0 launched on executor htex with executor id 6
1710615967.116996 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 6 will be sent to executor htex
1710615967.117031 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.117064 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 6 submitted for App wrapper, not waiting on any dependency
1710615967.117096 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 6 set to pending state with AppFuture: <AppFuture at 0x7ff87b90add0 state=pending>
1710615967.117125 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 6 will not be memoized
1710615967.117173 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_train_neg.smi'),)
1710615967.117221 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.117262 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.117289 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 6 try 0 launched on executor htex with executor id 7
1710615967.117323 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 7 will be sent to executor htex
1710615967.117370 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.117399 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 7 submitted for App wrapper, not waiting on any dependency
1710615967.117435 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 7 set to pending state with AppFuture: <AppFuture at 0x7ff87b90b110 state=pending>
1710615967.117491 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 7 will not be memoized
1710615967.117528 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_test_neg.smi'),)
1710615967.117591 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.117635 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.117665 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 7 try 0 launched on executor htex with executor id 8
1710615967.117698 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:949 submit DEBUG: Task 8 will be sent to executor htex
1710615967.117733 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:764 _add_output_deps DEBUG: Adding output dependencies
1710615967.117760 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1031 submit INFO: Task 8 submitted for App wrapper, not waiting on any dependency
1710615967.117790 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1037 submit DEBUG: Task 8 set to pending state with AppFuture: <AppFuture at 0x7ff87b90b450 state=pending>
1710615967.117820 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.memoization:222 check_memo DEBUG: Task 8 will not be memoized
1710615967.117852 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_val_neg.smi'),)
1710615967.117899 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615967.117937 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615967.117964 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 8 try 0 launched on executor htex with executor id 9
1710615967.118009 2024-03-16 12:06:07 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1156 wait_for_current_tasks INFO: Waiting for all remaining tasks to complete
1710615967.771389 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615967.771569 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615967.771627 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615967.771728 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615967.772154 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615967.772205 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615967.772229 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615967.772260 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615967.772344 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615967.772371 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615967.772400 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615967.772470 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615967.772493 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 0 connected workers
1710615967.772527 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615967.772553 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615967.772597 2024-03-16 12:06:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615972.828141 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615972.828320 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615972.828369 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615972.828476 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615972.828832 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615972.828886 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615972.828916 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615972.828954 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615972.829041 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615972.829066 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615972.829096 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615972.829180 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615972.829209 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615972.829243 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615972.829269 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615972.829293 2024-03-16 12:06:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615977.744892 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615977.745074 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615977.745125 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615977.745213 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615977.745542 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615977.745583 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615977.745609 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615977.745642 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615977.745739 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615977.745761 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615977.745789 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615977.745860 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615977.745883 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615977.745915 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615977.745945 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615977.745969 2024-03-16 12:06:17 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615981.969744 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710615981.971056 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615981.975023 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 0 try 0 failed
1710615981.975142 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 0 marked for retry
1710615981.975207 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 0 will not be memoized
1710615981.975272 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_train_neg.smi'),)
1710615981.975389 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615981.975452 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615981.975501 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 0 try 1 launched on executor htex with executor id 10
1710615981.976006 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615981.980082 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 1 try 0 failed
1710615981.980151 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 1 marked for retry
1710615981.980189 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 1 will not be memoized
1710615981.980227 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_test_neg.smi'),)
1710615981.980284 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615981.980332 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615981.980362 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 1 try 1 launched on executor htex with executor id 11
1710615981.980397 2024-03-16 12:06:21 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710615982.743937 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615982.744114 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615982.744164 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615982.744247 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615982.744623 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615982.744666 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615982.744690 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615982.744725 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615982.744826 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615982.744856 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615982.744887 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615982.744967 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615982.744991 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615982.745024 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615982.745050 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615982.745085 2024-03-16 12:06:22 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615987.751540 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615987.751726 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615987.751789 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615987.751888 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615987.752326 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615987.752380 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615987.752414 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615987.752456 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615987.752542 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615987.752574 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615987.752636 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615987.752712 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615987.752737 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615987.752771 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615987.752798 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615987.752824 2024-03-16 12:06:27 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615988.596370 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710615988.597193 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615988.601023 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 3 try 0 failed
1710615988.601113 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 3 marked for retry
1710615988.601184 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 3 will not be memoized
1710615988.601249 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_train_neg.smi'),)
1710615988.601357 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615988.601413 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615988.601459 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 3 try 1 launched on executor htex with executor id 12
1710615988.603490 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615988.607423 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 2 try 0 failed
1710615988.607493 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 2 marked for retry
1710615988.607532 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 2 will not be memoized
1710615988.607570 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BindingDB_val_neg.smi'),)
1710615988.607634 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615988.607680 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615988.607711 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 2 try 1 launched on executor htex with executor id 13
1710615988.607744 2024-03-16 12:06:28 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710615992.740016 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615992.740191 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615992.740241 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615992.740323 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615992.740603 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615992.740654 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615992.740677 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615992.740716 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615992.740803 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615992.740825 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615992.740854 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615992.740924 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615992.740947 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615992.740978 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615992.741004 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615992.741030 2024-03-16 12:06:32 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615995.341029 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710615995.342455 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615995.346370 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 4 try 0 failed
1710615995.346459 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 4 marked for retry
1710615995.346530 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 4 will not be memoized
1710615995.346615 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_test_neg.smi'),)
1710615995.346724 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615995.346778 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615995.346825 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 4 try 1 launched on executor htex with executor id 14
1710615995.347385 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710615995.351550 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 5 try 0 failed
1710615995.351647 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 5 marked for retry
1710615995.351683 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 5 will not be memoized
1710615995.351719 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/BIOSNAP_val_neg.smi'),)
1710615995.351782 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710615995.351827 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710615995.351873 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 5 try 1 launched on executor htex with executor id 15
1710615995.351907 2024-03-16 12:06:35 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710615997.746592 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710615997.746784 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710615997.746833 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615997.746918 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615997.747304 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615997.747345 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710615997.747369 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615997.747403 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615997.747499 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615997.747520 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710615997.747548 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710615997.747617 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710615997.747644 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710615997.747679 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710615997.747704 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710615997.747730 2024-03-16 12:06:37 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710615997.840798 2024-03-16 12:06:37 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710615997.840908 2024-03-16 12:06:37 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616001.608990 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616001.610208 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616001.614363 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 7 try 0 failed
1710616001.614461 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 7 marked for retry
1710616001.614535 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 7 will not be memoized
1710616001.614597 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_test_neg.smi'),)
1710616001.614704 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710616001.614757 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710616001.614802 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 7 try 1 launched on executor htex with executor id 16
1710616001.614836 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616001.941631 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616001.942271 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616001.946257 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 6 try 0 failed
1710616001.946335 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 6 marked for retry
1710616001.946381 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 6 will not be memoized
1710616001.946423 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_train_neg.smi'),)
1710616001.946490 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710616001.946553 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710616001.946584 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 6 try 1 launched on executor htex with executor id 17
1710616001.946612 2024-03-16 12:06:41 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616002.741798 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616002.741978 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616002.742028 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616002.742110 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616002.742444 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616002.742485 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710616002.742509 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616002.742540 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616002.742624 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616002.742646 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616002.742686 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616002.742756 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616002.742779 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616002.742816 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710616002.742842 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710616002.742867 2024-03-16 12:06:42 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616007.755147 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616007.755334 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616007.755383 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616007.755470 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616007.755875 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616007.755914 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 9
1710616007.755938 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616007.755970 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616007.756057 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616007.756079 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616007.756107 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616007.756177 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616007.756201 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 9 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616007.756231 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710616007.756257 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710616007.756283 2024-03-16 12:06:47 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616007.877944 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616007.878783 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616007.883439 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 8 try 0 failed
1710616007.883535 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:348 handle_exec_update INFO: Task 8 marked for retry
1710616007.883609 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.memoization:222 check_memo DEBUG: Task 8 will not be memoized
1710616007.883673 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.executor:566 submit DEBUG: Pushing function <function wrap_error.<locals>.wrapper at 0x7ff8836fe020> to queue with args (PosixPath('dataset/DAVIS_val_neg.smi'),)
1710616007.883773 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:120 put DEBUG: Sending TasksOutgoing message
1710616007.883826 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:122 put DEBUG: Sent TasksOutgoing message
1710616007.883854 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:725 launch_task INFO: Parsl task 8 try 1 launched on executor htex with executor id 18
1710616007.883895 2024-03-16 12:06:47 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616008.168742 2024-03-16 12:06:48 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616008.169300 2024-03-16 12:06:48 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616008.173288 2024-03-16 12:06:48 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 0 try 1 failed
1710616008.173389 2024-03-16 12:06:48 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 0 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616008.193521 2024-03-16 12:06:48 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616012.750339 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616012.750520 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616012.750571 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616012.750662 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616012.750939 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616012.750981 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 8
1710616012.751008 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616012.751045 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616012.751128 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616012.751150 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616012.751179 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616012.751262 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616012.751285 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 8 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616012.751316 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710616012.751341 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710616012.751366 2024-03-16 12:06:52 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616014.216894 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616014.218159 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616014.222226 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 1 try 1 failed
1710616014.222319 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 1 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616014.224833 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616014.445559 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616014.446115 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616014.450178 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 3 try 1 failed
1710616014.450248 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 3 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616014.452274 2024-03-16 12:06:54 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616017.742336 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616017.742517 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616017.742567 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616017.742654 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616017.743003 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616017.743041 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 6
1710616017.743065 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616017.743097 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616017.743182 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616017.743204 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616017.743232 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616017.743301 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616017.743323 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 6 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616017.743355 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710616017.743381 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710616017.743406 2024-03-16 12:06:57 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616021.026671 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616021.027818 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616021.031991 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 2 try 1 failed
1710616021.032081 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 2 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616021.036118 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616021.040356 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 4 try 1 failed
1710616021.040489 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 4 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616021.042764 2024-03-16 12:07:01 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616022.743531 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616022.743709 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616022.743759 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616022.743849 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616022.744172 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616022.744211 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 4
1710616022.744247 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616022.744278 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616022.744361 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616022.744387 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616022.744416 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616022.744486 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616022.744509 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 4 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616022.744540 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:253 _general_strategy DEBUG: Strategy case 2: slots are overloaded - (slot_ratio = active_slots/active_tasks) < parallelism
1710616022.744565 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:259 _general_strategy DEBUG: Strategy case 2a: active_blocks 1 >= max_blocks 1 so not scaling out
1710616022.744597 2024-03-16 12:07:02 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616027.437028 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616027.438471 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616027.442500 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 7 try 1 failed
1710616027.442590 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 7 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616027.445621 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616027.449677 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 5 try 1 failed
1710616027.449745 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 5 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616027.451754 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616027.743858 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616027.744042 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616027.744094 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616027.744177 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616027.744556 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616027.744600 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 2
1710616027.744624 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616027.744657 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616027.744747 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616027.744770 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616027.744798 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616027.744872 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616027.744895 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 2 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616027.744938 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:301 _general_strategy DEBUG: Strategy case 3: no changes necessary to current block load
1710616027.744964 2024-03-16 12:07:07 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616027.845793 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616027.845896 2024-03-16 12:07:07 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616032.747476 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:176 _general_strategy DEBUG: general strategy starting with strategy_type simple for 1 executors
1710616032.747733 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:184 _general_strategy DEBUG: Strategizing for executor htex
1710616032.747787 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616032.747873 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616032.748360 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616032.748400 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:205 _general_strategy DEBUG: Slot ratio calculation: active_slots = 2, active_tasks = 2
1710616032.748424 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616032.748455 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616032.748539 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616032.748561 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616032.748598 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616032.748680 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616032.748704 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:208 _general_strategy DEBUG: Executor htex has 2 active tasks, 1/0 running/pending blocks, and 2 connected workers
1710616032.748740 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.jobs.strategy:301 _general_strategy DEBUG: Strategy case 3: no changes necessary to current block load
1710616032.748766 2024-03-16 12:07:12 MainProcess-312066 JobStatusPoller-Timer-Thread-140705201274128-140705200989952 parsl.process_loggers:28 wrapped DEBUG: Normal ending for _general_strategy on thread JobStatusPoller-Timer-Thread-140705201274128
1710616033.620911 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616033.621775 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616033.625729 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 6 try 1 failed
1710616033.625811 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 6 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616033.628580 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616033.732879 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:158 get DEBUG: Received ResultsIncoming message
1710616033.733427 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.app.errors:114 reraise DEBUG: Reraising exception of type <class 'torch._dynamo.exc.Unsupported'>
1710616033.737163 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:305 handle_exec_update DEBUG: Task 8 try 1 failed
1710616033.737236 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.dataflow.dflow:351 handle_exec_update ERROR: Task 8 failed after 1 retry attempts
Traceback (most recent call last):
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 302, in handle_exec_update
    res = self._unwrap_remote_exception_wrapper(future)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/dataflow/dflow.py", line 572, in _unwrap_remote_exception_wrapper
    result.reraise()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 118, in reraise
    raise v
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/parsl/app/errors.py", line 141, in wrapper
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 197, in embed_file
    avg_embeddings = compute_avg_embeddings(model, dataloader)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/lambda_stor/data/avasan/protein-search/protein_search/distributed_inference.py", line 143, in compute_avg_embeddings
    outputs = model(**inputs, output_hidden_states=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 489, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/eval_frame.py", line 655, in catch_errors
    return callback(frame, cache_entry, hooks, frame_state)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 383, in _convert_frame_assert
    compiled_product = _compile(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 646, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 244, in time_wrapper
    r = func(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 562, in compile_inner
    out_code = transform_code_object(code, transform)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/bytecode_transformation.py", line 1033, in transform_code_object
    transformations(instructions, code_options)
      ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 151, in _fn
    return fn(*args, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/convert_frame.py", line 527, in transform
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2128, in run
    super().run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/nn_module.py", line 328, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1252, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars.items)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 294, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 248, in call_function
    return super().call_function(tx, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/functions.py", line 81, in call_function
    return tx.inline_user_function_return(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 688, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2261, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 2376, in inline_call_
    tracer.run()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 818, in run
    and self.step()
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 781, in step
    getattr(self, inst.opname)(inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 470, in wrapper
    return inner_fn(self, inst)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 1802, in CALL
    self.call_function(fn, args, kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/symbolic_convert.py", line 652, in call_function
    self.push(fn.call_function(self, args, kwargs))
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/torch.py", line 542, in call_function
    tensor_variable = wrap_fx_proxy(
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1314, in wrap_fx_proxy
    return wrap_fx_proxy_cls(target_cls=TensorVariable, **kwargs)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/variables/builder.py", line 1399, in wrap_fx_proxy_cls
    example_value = get_fake_value(proxy.node, tx, allow_non_graph_fake=True)
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/utils.py", line 1499, in get_fake_value
    unimplemented(f"data dependent operator: {cause.func}")
    ^^^^^^^^^^^^^^^^^
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/_dynamo/exc.py", line 193, in unimplemented
    raise Unsupported(msg)
      ^^^^^^^^^^^^^^^^^
torch._dynamo.exc.Unsupported: data dependent operator: aten.equal.default

from user code:
   File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 682, in forward
    encoder_outputs = self.encoder(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 426, in forward
    layer_outputs = layer_module(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 361, in forward
    self_attention_outputs = self.attention(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 301, in forward
    self_outputs = self.self(
  File "/homes/avasan/miniconda3/envs/esm_align/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/homes/avasan/.cache/huggingface/modules/transformers_modules/ibm/MoLFormer-XL-both-10pct/16076bfe31080edbc0bdb1f1765af324a1e4f4ec/modeling_molformer.py", line 215, in forward
    if not torch.equal(attention_mask, per_query_extended):

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


You can suppress this exception and fall back to eager by setting:
    import torch._dynamo
    torch._dynamo.config.suppress_errors = True

1710616033.739178 2024-03-16 12:07:13 MainProcess-312066 HTEX-Queue-Management-Thread-140704940553984 parsl.executors.high_throughput.zmq_pipes:156 get DEBUG: Waiting for ResultsIncoming message
1710616033.739247 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1172 wait_for_current_tasks INFO: All remaining tasks completed
1710616033.739373 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1182 cleanup INFO: DFK cleanup initiated
1710616033.739419 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1075 log_task_states INFO: Summary of tasks in DFK:
1710616033.739498 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.unsched: 0
1710616033.739523 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.pending: 0
1710616033.739546 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.running: 0
1710616033.739566 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.exec_done: 0
1710616033.739586 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.failed: 9
1710616033.739605 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.dep_fail: 0
1710616033.739625 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.launched: 0
1710616033.739653 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.fail_retryable: 0
1710616033.739673 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.memo_done: 0
1710616033.739696 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.joining: 0
1710616033.739717 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1079 log_task_states INFO: Tasks in state States.running_ended: 0
1710616033.739736 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1081 log_task_states INFO: End of summary
1710616033.739884 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1206 cleanup INFO: Closing job status poller
1710616033.740059 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1208 cleanup INFO: Terminated job status poller
1710616033.740090 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1210 cleanup INFO: Scaling in and shutting down executors
1710616033.740118 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1215 cleanup INFO: Scaling in executor htex
1710616033.740155 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:637 scale_in DEBUG: Scale in called, blocks=1, block_ids=[]
1710616033.740183 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616033.740227 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616033.740547 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616033.740599 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:653 scale_in DEBUG: Scale in selecting from 1 blocks
1710616033.740660 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616033.740696 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616033.740814 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616033.740847 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:530 _hold_block DEBUG: Sending hold to manager: 372805335790
1710616033.740873 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:57 run DEBUG: Sending command client command
1710616033.740909 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:59 run DEBUG: Waiting for command client response
1710616033.741369 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.zmq_pipes:61 run DEBUG: Received command client response
1710616033.741402 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:497 hold_worker DEBUG: Sent hold request to manager: 372805335790
1710616033.741442 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.providers.local.local:269 cancel DEBUG: Terminating job/proc_id: 312112
1710616033.814246 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1228 cleanup INFO: Shutting down executor htex
1710616033.814469 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:700 shutdown INFO: Attempting HighThroughputExecutor shutdown
1710616033.814576 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.high_throughput.executor:702 shutdown INFO: Finished HighThroughputExecutor shutdown attempt
1710616033.814607 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1230 cleanup INFO: Shut down executor htex
1710616033.814650 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1228 cleanup INFO: Shutting down executor _parsl_internal
1710616033.814705 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.threads:74 shutdown DEBUG: Shutting down executor, which involves waiting for running tasks to complete
1710616033.814771 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.executors.threads:76 shutdown DEBUG: Done with executor shutdown
1710616033.814794 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1230 cleanup INFO: Shut down executor _parsl_internal
1710616033.814817 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1232 cleanup INFO: Terminated executors
1710616033.814852 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1249 cleanup INFO: DFK cleanup complete
1710616033.814884 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.process_loggers:28 wrapped DEBUG: Normal ending for cleanup on thread MainThread
1710616033.815116 2024-03-16 12:07:13 MainProcess-312066 MainThread-140708346079040 parsl.dataflow.dflow:1148 atexit_cleanup INFO: python process is exiting, but DFK has already been cleaned up
